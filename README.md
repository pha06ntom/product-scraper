# Product scraper (Golang + Chromedp)

–ü–∞—Ä—Å–µ—Ä —Ç–æ–≤–∞—Ä–æ–≤ –∏ —Ü–µ–Ω –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–æ–≤ (–ø—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã ‚Äî –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑ `kuper.ru`).  
–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–±–∏—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —Å –ª—é–±–æ–≥–æ —Å–∞–π—Ç–∞ –∏–∑ –∑–∞–¥–∞–Ω–∏—è:  
`okeydostavka.ru`, `kuper.ru`, `samokat.ru`, `lenta.com`.

- –Ø–∑—ã–∫: **Go**
- –ë—Ä–∞—É–∑–µ—Ä: **Headless Chrome** —á–µ—Ä–µ–∑ `chromedp`
- –ü—Ä–æ–∫—Å–∏: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **HTTP-–ø—Ä–æ–∫—Å–∏** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî –ª–æ–∫–∞–ª—å–Ω—ã–π `tinyproxy`)
- –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö: **JSON network responses**, –∞ –Ω–µ HTML-—Ä–∞–∑–º–µ—Ç–∫–∞

–≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –¥–µ–ª–∞–µ—Ç —Ä–µ—à–µ–Ω–∏–µ —É—Å—Ç–æ–π—á–∏–≤—ã–º –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ:  
–ø–∞—Ä—Å–µ—Ä –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ CSS-–∫–ª–∞—Å—Å–∞–º –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ DOM.

---

## üí° –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –†–∞–±–æ—Ç–∞ —á–µ—Ä–µ–∑ HTTP-–ø—Ä–æ–∫—Å–∏  
- –ü–µ—Ä–µ—Ö–≤–∞—Ç **JSON** –æ—Ç–≤–µ—Ç–æ–≤ backend API —á–µ—Ä–µ–∑ CDP `network`
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ:
  - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞  
  - —Ü–µ–Ω–∞  
  - —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ç–æ–≤–∞—Ä  
- –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –ø–æ —Å–ø–∏—Å–∫—É –∫–∞—Ç–µ–≥–æ—Ä–∏–π  
- –í—ã–≥—Ä—É–∑–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ CSV (`name,price,url`)
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –º–æ–¥—É–ª–∏

---

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
cmd/lenta-scraper      ‚Üí —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (main)
internal/app           ‚Üí —á—Ç–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–∞, –∑–∞–ø—É—Å–∫ –±—Ä–∞—É–∑–µ—Ä–∞, –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è
internal/browser       ‚Üí —Ä–∞–±–æ—Ç–∞ —Å chromedp:
   ‚îú‚îÄ browser.go       ‚Üí –∑–∞–ø—É—Å–∫ Chrome, –ø—Ä–æ–∫—Å–∏, –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã
   ‚îî‚îÄ network.go       ‚Üí –ø–µ—Ä–µ—Ö–≤–∞—Ç JSON-–æ—Ç–≤–µ—Ç–æ–≤
internal/extract       ‚Üí –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã—Ö JSON
internal/output        ‚Üí –∑–∞–ø–∏—Å—å CSV
configs/               ‚Üí YAML-–∫–æ–Ω—Ñ–∏–≥–∏
```

**–ö–ª—é—á–µ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ:**  
HTML **–Ω–µ –ø–∞—Ä—Å–∏—Ç—Å—è**, –¥–∞–Ω–Ω—ã–µ –±–µ—Ä—É—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –∏–∑ —Å–µ—Ç–µ–≤—ã—Ö JSON-–æ—Ç–≤–µ—Ç–æ–≤ ‚Äî —Ç–∞–∫ –Ω–∞–¥—ë–∂–Ω–µ–µ.

---

## ‚öô –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ü—Ä–∏–º–µ—Ä (`configs/local.yaml`):

```yaml
proxy: "http://127.0.0.1:8888"
address: "–ú–æ—Å–∫–≤–∞, –¢–≤–µ—Ä—Å–∫–∞—è 1"

categories:
  - "https://kuper.ru/catalog/molochnye-produkty"
  - "https://kuper.ru/catalog/hleb-i-vypechka"

out_csv: "dump.csv"
headless: true
timeout_sec: 60
scrolls: 6
skip_address: true

proxy_user: ""
proxy_pass: ""
```

---

## üìå –û–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

| –ü–æ–ª–µ                   | –ó–Ω–∞—á–µ–Ω–∏–µ                                     |
|------------------------|----------------------------------------------|
| `proxy`                | HTTP-–ø—Ä–æ–∫—Å–∏ (–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω)                    |
| `proxy_user`, `proxy_pass` | –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–∞ –ø—Ä–æ–∫—Å–∏, –µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è |
| `address`              | –ß–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–π –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏             |
| `categories`           | –°–ø–∏—Å–æ–∫ URL –∫–∞—Ç–µ–≥–æ—Ä–∏–π                        |
| `out_csv`              | –ü—É—Ç—å –∫ –∏—Ç–æ–≥–æ–≤–æ–º—É CSV                        |
| `headless`             | –ó–∞–ø—É—Å–∫ headless Chrome                      |
| `timeout_sec`          | –¢–∞–π–º–∞—É—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏                 |
| `scrolls`              | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–∫—Ä—É—Ç–æ–∫ –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –ø–æ–¥–≥—Ä—É–∑–∫–∏ |
| `skip_address`         | –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –≤—ã–±–æ—Ä –∞–¥—Ä–µ—Å–∞ (—É–¥–æ–±–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏) |

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1Ô∏è‚É£ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ tinyproxy

```bash
sudo apt install tinyproxy
sudo systemctl enable tinyproxy
sudo systemctl restart tinyproxy
```

–ü–æ—Ä—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: **8888**.

---

### 2Ô∏è‚É£ –°–æ–∑–¥–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥

```bash
cp configs/example.yaml configs/local.yaml
```

–û–±–Ω–æ–≤–∏—Ç—å –≤ `local.yaml`:

```yaml
proxy: "http://127.0.0.1:8888"
```

---

### 3Ô∏è‚É£ –ó–∞–ø—É—Å–∫

```bash
go run ./cmd/lenta-scraper --config configs/local.yaml
```

–∏–ª–∏ —á–µ—Ä–µ–∑ Makefile:

```bash
make run
```

---

### 4Ô∏è‚É£ –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

```bash
head dump.csv
```

–ü—Ä–∏–º–µ—Ä —Ñ–æ—Ä–º–∞—Ç–∞:

```csv
name,price,url
"–ú–æ–ª–æ–∫–æ –ø–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–µ 3.2% 1–ª",89.99,https://example.com/product/123
"–•–ª–µ–± –ø—à–µ–Ω–∏—á–Ω—ã–π –Ω–∞—Ä–µ–∑–Ω–æ–π 500–≥",49.90,https://example.com/product/456
...
```

---

## üìù –ó–∞–º–µ—á–∞–Ω–∏—è

- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –¥—Ä—É–≥–∏—Ö —Å–∞–π—Ç–æ–≤:  
  **Lenta, Samokat, Okey, Kuper**.
- –ï—Å–ª–∏ –≤–µ—Ä—Å—Ç–∫–∞ —Å–∞–π—Ç–∞ –º–µ–Ω—è–µ—Ç—Å—è ‚Äî backend JSON API –æ–±—ã—á–Ω–æ –æ—Å—Ç–∞—ë—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º.
- –ü—Ä–æ–µ–∫—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω –ø–æ best practices Go:
  - —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –º–æ–¥—É–ª–∏  
  - —á–∏—Å—Ç—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏  
  - –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å–≤—è–∑–Ω–æ—Å—Ç—å  

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ **MIT License**.
